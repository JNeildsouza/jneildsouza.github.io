<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Text Encryption</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        textarea {
            width: 100%;
            height: 200px;
            margin-bottom: 10px;
        }
        .output {
            background-color: #f5f5f5;
            padding: 10px;
            border: 1px solid #ddd;
            min-height: 100px;
            margin-top: 20px;
            white-space: pre-wrap;
            display: none;
        }
        button {
            padding: 10px 15px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            margin-right: 10px;
        }
        .error {
            color: red;
            margin-top: 10px;
            display: none;
        }
    </style>
</head>
<body>
    <h1>Simple Text Encryption Test</h1>
    
    <div>
        <h2>Encrypt</h2>
        <textarea id="input-text" placeholder="Enter text to encrypt..."></textarea>
        <input type="text" id="password" placeholder="Enter password" style="width: 100%; margin-bottom: 10px;">
        <button id="encrypt-btn">Encrypt</button>
        <div class="error" id="encrypt-error"></div>
        <div class="output" id="encrypted-output"></div>
    </div>
    
    <div style="margin-top: 40px;">
        <h2>Decrypt</h2>
        <textarea id="encrypted-input" placeholder="Paste encrypted text here..."></textarea>
        <input type="text" id="decrypt-password" placeholder="Enter password" style="width: 100%; margin-bottom: 10px;">
        <button id="decrypt-btn">Decrypt</button>
        <div class="error" id="decrypt-error"></div>
        <div class="output" id="decrypted-output"></div>
    </div>

    <script>
        // Simple XOR encryption
        function encrypt(text, password) {
            let result = '';
            for (let i = 0; i < text.length; i++) {
                const charCode = text.charCodeAt(i) ^ password.charCodeAt(i % password.length);
                result += String.fromCharCode(charCode);
            }
            return btoa(result); // Convert to base64
        }
        
        // Decrypt
        function decrypt(encryptedBase64, password) {
            try {
                const encryptedText = atob(encryptedBase64); // Convert from base64
                let result = '';
                for (let i = 0; i < encryptedText.length; i++) {
                    const charCode = encryptedText.charCodeAt(i) ^ password.charCodeAt(i % password.length);
                    result += String.fromCharCode(charCode);
                }
                return result;
            } catch (error) {
                throw new Error("Decryption failed. Invalid format or wrong password.");
            }
        }
        
        // Event handlers
        document.getElementById('encrypt-btn').addEventListener('click', function() {
            const text = document.getElementById('input-text').value;
            const password = document.getElementById('password').value;
            const errorElement = document.getElementById('encrypt-error');
            const outputElement = document.getElementById('encrypted-output');
            
            errorElement.style.display = 'none';
            
            if (!text.trim() || !password.trim()) {
                errorElement.textContent = 'Please enter both text and password.';
                errorElement.style.display = 'block';
                return;
            }
            
            try {
                const encrypted = encrypt(text, password);
                outputElement.textContent = encrypted;
                outputElement.style.display = 'block';
                console.log("Encryption successful");
            } catch (error) {
                errorElement.textContent = error.message;
                errorElement.style.display = 'block';
                console.error("Encryption error:", error);
            }
        });
        
        document.getElementById('decrypt-btn').addEventListener('click', function() {
            const encryptedText = document.getElementById('encrypted-input').value;
            const password = document.getElementById('decrypt-password').value;
            const errorElement = document.getElementById('decrypt-error');
            const outputElement = document.getElementById('decrypted-output');
            
            errorElement.style.display = 'none';
            
            if (!encryptedText.trim() || !password.trim()) {
                errorElement.textContent = 'Please enter both encrypted text and password.';
                errorElement.style.display = 'block';
                return;
            }
            
            try {
                const decrypted = decrypt(encryptedText, password);
                outputElement.textContent = decrypted;
                outputElement.style.display = 'block';
                console.log("Decryption successful");
            } catch (error) {
                errorElement.textContent = error.message;
                errorElement.style.display = 'block';
                console.error("Decryption error:", error);
            }
        });
        
        // Add a simple test on load to verify JS is working
        window.addEventListener('load', function() {
            console.log("Page loaded successfully. JavaScript is running.");
            // Create a test element to verify DOM manipulation works
            const testElement = document.createElement('div');
            testElement.style.display = 'none';
            testElement.id = 'js-test';
            document.body.appendChild(testElement);
            console.log("DOM manipulation test successful:", document.getElementById('js-test') !== null);
        });
    </script>
</body>
</html>
